<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Image Grid with Multi-Filters & Resize</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .filters { margin-bottom: 20px; }
    .filter-button {
      padding: 8px 12px;
      margin: 5px;
      border: 2px solid #ccc; /* Light gray outline */
      cursor: pointer;
      border-radius: 4px;
      background: #f9f9f9;
    }
    .filter-button.active { outline: 3px solid #000; outline-offset: 2px; }
    .color-filter {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      border: 2px solid #ccc; /* Light gray outline */
      margin: 5px;
      cursor: pointer;
      display: inline-block;
    }
    .color-filter.active { outline: 3px solid #000; outline-offset: 2px; }
    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 10px; }
    .grid div { display: flex; justify-content: center; align-items: center; background: #f0f0f0; border: 1px solid #ddd; overflow: hidden; }
    .grid img { width: 100%; height: 100%; object-fit: contain; }
    .size-controls { margin-bottom: 20px; }
    .size-controls button { margin: 0 5px; padding: 6px 10px; border: 2px solid #ccc; background: #f9f9f9; cursor: pointer; border-radius: 4px; }
    footer { margin-top: 40px; text-align: right; font-size: 0.9em; color: #555; }
  </style>
</head>
<body>

<div class="filters">
  <div>
    <button class="filter-button" data-type="gif">.gif</button>
    <button class="filter-button" data-type="jpg">.jpg/.jpeg</button>
    <button class="filter-button" data-type="png">.png</button>
  </div>
  <div>
    <button class="filter-button" data-alpha="true">Has Alpha</button>
  </div>
  <div>
    <button class="filter-button clear-colors">Clear Colors</button>
    <div class="color-filters"></div>
  </div>
</div>

<div class="size-controls">
  <button id="decrease">-</button>
  <span>Adjust Image Size</span>
  <button id="increase">+</button>
</div>

<div class="grid" id="imageGrid"></div>

<footer id="versionInfo"></footer>

<script>
const themeColors = {
  green: "#34A853",
  blue: "#4285F4",
  yellow: "#FBBC04",
  red: "#EA4335",
  gray: "#5f6469",
  black: "#000000",
  white: "#ffffff"
};

// Version tracking
const versionNumber = 1; // Increment with each new code output
const now = new Date();
const pad = num => String(num).padStart(2,'0');
const timestamp = `${pad(now.getMonth()+1)}/${pad(now.getDate())}/${String(now.getFullYear()).slice(-2)}, ${pad(now.getHours())}:${pad(now.getMinutes())}:${pad(now.getSeconds())}`;
document.getElementById('versionInfo').textContent = `Version ${versionNumber} | ${timestamp}`;

let currentSize = 160;
let allImages = [];
let activeFileFilters = new Set();
let activeAlphaFilter = null;
let activeThemeFilter = null;

async function loadImages() {
  const res = await fetch("https://raw.githubusercontent.com/jkupczak/google-fiber-imagery/refs/heads/main/images.json");
  const data = await res.json();
  allImages = data;
  renderThemeFilters(data);
  renderImages();
}

function renderThemeFilters(data) {
  const container = document.querySelector(".color-filters");
  container.innerHTML = "";

  const themes = [...new Set(data.map(img => img.theme && img.theme.toLowerCase()))]
    .filter(theme => theme && themeColors[theme]);

  themes.forEach(theme => {
    const btn = document.createElement("div");
    btn.className = "color-filter";
    btn.style.backgroundColor = themeColors[theme];
    btn.dataset.theme = theme;
    btn.addEventListener("click", () => {
      if (activeThemeFilter === theme) {
        activeThemeFilter = null;
        btn.classList.remove("active");
      } else {
        activeThemeFilter = theme;
        document.querySelectorAll(".color-filter").forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
      }
      renderImages();
    });
    container.appendChild(btn);
  });
}

function renderImages() {
  const grid = document.getElementById("imageGrid");
  grid.innerHTML = "";

  let filtered = allImages.filter(img => {
    if (img.theme === null || img.theme === "null") return false;

    // File filter
    let ext = img.url.split(".").pop().toLowerCase();
    if (ext === "jpeg") ext = "jpg";
    if (activeFileFilters.size && !activeFileFilters.has(ext)) return false;

    // Alpha filter
    if (activeAlphaFilter !== null && img.has_alpha !== activeAlphaFilter) return false;

    // Theme filter
    if (activeThemeFilter && img.theme.toLowerCase() !== activeThemeFilter) return false;

    return true;
  });

  filtered.forEach(img => {
    const wrapper = document.createElement("div");
    const image = document.createElement("img");
    image.src = img.url;
    wrapper.style.width = wrapper.style.height = currentSize + "px";
    image.style.width = image.style.height = "100%";
    wrapper.appendChild(image);
    grid.appendChild(wrapper);
  });
}

// File type filters
document.querySelectorAll(".filter-button[data-type]").forEach(btn => {
  btn.addEventListener("click", () => {
    const type = btn.dataset.type;
    if (activeFileFilters.has(type)) {
      activeFileFilters.delete(type);
      btn.classList.remove("active");
    } else {
      activeFileFilters.add(type);
      btn.classList.add("active");
    }
    renderImages();
  });
});

// Alpha filter
document.querySelector(".filter-button[data-alpha]").addEventListener("click", e => {
  if (activeAlphaFilter) {
    activeAlphaFilter = null;
    e.target.classList.remove("active");
  } else {
    activeAlphaFilter = true;
    e.target.classList.add("active");
  }
  renderImages();
});

// Clear color button
document.querySelector(".clear-colors").addEventListener("click", e => {
  activeThemeFilter = null;
  document.querySelectorAll(".color-filter").forEach(b => b.classList.remove("active"));
  renderImages();
});

// Image size controls
document.getElementById("increase").addEventListener("click", () => { currentSize += 20; renderImages(); });
document.getElementById("decrease").addEventListener("click", () => { if (currentSize > 40) { currentSize -= 20; renderImages(); } });

loadImages();
</script>
</body>
</html>
